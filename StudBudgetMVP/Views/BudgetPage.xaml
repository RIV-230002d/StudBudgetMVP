<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="StudBudgetMVP.Views.BudgetPage"
             Title="Бюджет">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="15">

            <!-- ==== строка доход / расход ==== -->
            <Grid ColumnDefinitions="*,*" Margin="0,0,0,15">
                <Label Text="{Binding TotalIncome, StringFormat='+{0:C}'}"
                       TextColor="Green"
                       FontAttributes="Bold"
                       HorizontalOptions="Start" />

                <Label Text="{Binding TotalExpense, StringFormat='-{0:C}'}"
                       TextColor="Red"
                       FontAttributes="Bold"
                       HorizontalOptions="End"
                       Grid.Column="1" />
            </Grid>

            <!-- ==== форма добавления категории ==== -->
            <Label Text="Новая категория" FontAttributes="Bold" />

            <Entry Placeholder="Название категории"
                   Text="{Binding NewCategoryName}" />

            <HorizontalStackLayout Spacing="10">
                <RadioButton Content="Доход"
                             GroupName="Type"
                             IsChecked="{Binding NewIsIncome}" />
                <RadioButton Content="Расход"
                             GroupName="Type"
                             IsChecked="{Binding NewIsIncome, Converter={StaticResource InverseBoolConverter}}" />
            </HorizontalStackLayout>

            <Entry Placeholder="Лимит (₽)"
                   Keyboard="Numeric"
                   Text="{Binding NewLimit}"
                   IsVisible="{Binding IsExpense}" />

            <Button Text="Сохранить" Command="{Binding AddCommand}" />
            <Button Text="Удалить"   Command="{Binding DeleteCommand}" />

            <!-- ==== список доходных ==== -->
            <Label Text="Доходы:" FontAttributes="Bold" Margin="0,15,0,0"/>
            <CollectionView ItemsSource="{Binding IncomeCategories}"
                            HeightRequest="140">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame Padding="5" BorderColor="Gray" Margin="0,3">
                            <Label Text="{Binding Name}" />
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- ==== список расходных ==== -->
            <Label Text="Расходы:" FontAttributes="Bold" Margin="0,15,0,0"/>
            <CollectionView ItemsSource="{Binding ExpenseCategories}"
                            HeightRequest="200">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame Padding="5" BorderColor="Gray" Margin="0,3">
                            <VerticalStackLayout>
                                <Label Text="{Binding Name}" />
                                <Label Text="{Binding Limit, StringFormat='Лимит: {0:C}'}"
                                       FontSize="Small"
                                       TextColor="DarkGray" />
                            </VerticalStackLayout>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- Перерасход скрыт по заданию -->

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>